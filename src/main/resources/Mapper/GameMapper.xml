<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.Dao.GameDao">
    <resultMap id="Game" type="com.example.Dao.Game">
        <id column="game_number" property="game_number" javaType="int" jdbcType="INTEGER"/>
        <result column="game_name" property="game_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result column="game_info" property="game_info" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result column="game_rule" property="game_rule" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result column="game_image" property="game_image" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="Gamerecord" type="com.example.Dao.Gamerecord">
        <id column="gamerecord_number" property="number" javaType="int" jdbcType="INTEGER"/>
        <result column="gamerecord_total" property="total" javaType="int" jdbcType="INTEGER"/>
        <result column="gamerecord_win" property="win" javaType="int" jdbcType="INTEGER"/>
        <result column="gamerecord_draw" property="draw" javaType="int" jdbcType="INTEGER"/>
        <result column="gamerecord_lose" property="lose" javaType="int" jdbcType="INTEGER"/>
        <result column="game_number" property="game_number" javaType="int" jdbcType="INTEGER"/>
        <result column="member_number" property="member_number" javaType="int" jdbcType="INTEGER"/>
    </resultMap>


    <select id="Selectbykey" parameterType="int" resultMap="Game">
        select *
        from GAME
        where game_number=#{game_number}
    </select>

    <select id="Selectbyname" parameterType="java.lang.String" resultMap="Game">
        select *
        from GAME
        where game_name=#{game_name}
    </select>

    <select id="keybynick" parameterType="java.lang.String" resultType="java.lang.Integer">
        select member_number
        from MEMBER
        where member_nickname=#{member_nickname}
    </select>

    <select id="SelectAll" resultMap="Game">
        select *
        from GAME
    </select>


    <select id="SelectRank" resultMap="Game">
        Select game.*
        From purchase RIGHT JOIN game ON purchase.game_number = game.game_number
        group by game.game_number
        order by count(member_number) desc
    </select>

    <select id="SelectRankCount" resultType="java.lang.Integer">
        Select count(member_number)
        From purchase RIGHT JOIN game ON purchase.game_number = game.game_number
        group by game.game_number
        order by count(member_number) desc
    </select>

    <insert id="Buygame"  parameterType="com.example.Dao.Purchase">
		insert into
		purchase(purchase_date, member_number, game_number)
		values(#{purchase_date}, #{member_number}, #{game_number})
	</insert>

    <select id="Checkingbuy" parameterType="java.util.HashMap" resultType="java.lang.Integer">
        select count(*)
        from purchase
        where purchase.member_number = #{member} AND purchase.game_number = #{game}
    </select>

    <select id="Mygamelist" parameterType="java.lang.Integer" resultMap="Game">
        select *
        from game join purchase on game.game_number = purchase.game_number
        where purchase.member_number = #{member_number}
    </select>

    <select id="Statbynick" parameterType="java.util.HashMap" resultMap="Gamerecord">
        select *
        from gamerecord
        where gamerecord.member_number = #{member} AND gamerecord.game_number = #{game}
    </select>
</mapper>